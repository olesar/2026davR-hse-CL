---
title: "HW3. Hypothesis testing"
output: html_document
---

# HW3. Тестирование гипотез. t-test. Корреляции 

Домашнее задание сдается на почту в виде двух файлов, Rmd и html (или в виде тетрадки, если вы выполняли задание в колабе). Чтобы облегчить проверку домашнего задания, мы просим вас писать код в блоки для кода на R, например,

```{r example}
# YOUR CODE HERE 
# (do not forget to remove #'s and all this text so that we could run the code)
```

и текст в блоки для текста. Пожалуйста, впишите ниже ваше имя и фамилию:

```{txt name}
     YOUR NAME HERE
```

Перед сдачей домашнего задания рекомендуем запустить `Run All` или сгенерировать html-страницу с помощью `Knit`, чтобы убедиться, что в финальной версии весь ваш код будет запускаться без проблем. Дисклеймер - в зависимости от среды, в которой вы выполняете задания, округление непрерывных значений может производиться несколько по-разному. В заданиях ниже не будут оцениваться расхождения с образцом в количестве знаков после запятой в выдаче. Аналогично, несколько иначе могут выглядеть шрифты в таблицах и графиках, на такие расхождения тоже не стоит обращать внимания, если нет специального требования в задании. И не стесняйтесь задавать вопросы по домашнему заданию в телеграм-группе.

## 1. Частотность и фонетика

(Первая часть домашнего задания строится на тех же данных, что были в предыдущем домашнем задании. Вы можете пропустить описание, если знакомы с датасетом) 

Во многих лингвистических исследованиях отмечается, что часто используемые в языке слова звучат короче, а при их произнесении наблюдается редукция и коартикуляция. Работа Fabian Tomaschek et al. (2018) исследует гипотезу, что моторные навыки произнесения улучшаются с опытом, который, в свою очередь, напрямую связан с частотностью слова. Ученые попросили испытуемых (17 бакалавров университета Тюбингена, 8 мужчин и 9 женщин) прочитать вслух немецкие глаголы, содержащие звук [a:] в основе. Испытуемые были поставлены в экспериментальные условия, которые исподволь заставляли их читать быстрее или медленнее (slow/fast condition).

В этом задании мы просим вас сравнить длину звучания всего слова целиком, а также длину звучания интересующего ученых сегмента (звука [a:]) в условиях slow и fast. Хотя логично предположить, что в условии fast произнесение и слов, и сегментов будет короче, все же нужно убедиться, что данные это подтверждают, прежде чем переходить к более сложному анализу по сути вопроса. Кроме того, мы будем уверены, что экспериментальные условия были должным образом соблюдены, ученые не запутались в кодировании данных и документировали результаты корректно.

Интересующие нас переменные:

LogDurationW - log-transformed word duration (логарифм длины произнесения слова)
LogDurationA - log-transformed segment duration (логарифм длины произнесения сегмента)
Cond - condition: slow vs. fast (условие).

Ссылка на данные [link](https://raw.githubusercontent.com/LingData2019/LingData2020/master/data/dur_word_frequency.csv)

### 1.0 t-test

С помощью t-критерия Стьюдента мы хотим определить статистическую значимость различия значений применительно к следующим переменным:  

(a) word durarion in fast condition and word duration in slow condition,

(b) segment duration in fast condition and segment duration in slow condition. 

Что мы хотим проверить, используя t-критерия Стьюдента?  
1) что если мы возьмем любую другую выборку, то в ней средние по этим переменным будут различаться 
2) что различие этих длительностей имеет место не только на выборках, но и в генеральной совокупности 
3) мы хотим подтвердить, что наша нулевая гипотеза верна

```{txt 1.0}
 YOUR ANSWER HERE
```

#### 1.1 Гипотезы 

В первую очередь, сформулируйте нулевую гипотезу (H_0) и альтернативную гипотезу (H_1). Если для выполнения задания нужно сформулировать несколько H_0 и H_1, сделайте это, продублировав этот и следующий разделы (1.1а, 1.2a, 1.3.a, 1.1b, 1.2b и т.д.)  

```
H0: 

H1:
```

#### 1.2 Тест  

Загрузите данные и примените `t.test` для проверки гипотез.  

```{r t-test}
# YOUR CODE HERE

```


#### 1.3 Интерпретация  

Интерпретируйте результаты t-теста. Включите в вывод t-статистику, степени свободы и p-values. Можно ли заключить, что имеется различие в длительности слов в быстрых и медленных условиях в генеральной совокупности? Можно ли заключить то же самое в отношении длительности сегментов?  

```{txt t-test-interpret}
 YOUR ANSWER HERE

```

## 2. Дискуссия 

Возможно, применение t-test в чистом виде является не лучшей опцией для решения задачи 1.0. Если вам тоже так кажется, приведите аргументы против его использования и предложите другое решение. 

```{txt discussion}
 YOUR ANSWER HERE

```

#### 2.1 Код для решения    

Напишите код, который может помочь в аргументации и покажет другое решение. 

```{r alternative} 
# YOUR CODE HERE

```


## 3. Корреляционный анализ  

Датасет представляет (с изменениями) данные из статьи *Hansen (2016). What makes a word easy to acquire?* [link](http://dx.doi.org/10.1177/0142723716679956). Автора интересовало, связано ли усвоение того или иного слова с другими факторами, такими как частота слова в языке в целом или в речи родителей. Кроме того, он рассматривал гипотезы, что присутствие тех или иных букв или звуков в слове, а также лексическая категория, к которой относится слово, могли бы быть связаны с возрастом усвоения.  

Переменные:  
* `WordNo` --  слово в норвежском языке  
* `Translation` -- перевод на английский  
* `AgeOfAcq` -- возраст, в котором было усвоено слово, в месяцах (оценка по MacArthur-Bates Communicative Development Inventories). Указаны данные от 12 до 36 месяцев (от года до 3 лет)     
* `CumulOtherWords` -- как много других слов ребенок знает к моменту освоения данного слова (округлено до 10)  
* `WordCategory` -- узкая категория, к которой относится слово (например, `people` или `action words`)  
* `BroadCategory` -- широкая категория, к которой относится слово (например, `nominals` или `predicates`) * `FreqCorpus` -- частота слова в некотором корпусе норвежского языка  
* `ParentFreq` -- частота слова в речи родителей, обращенной к ребенку (по данным норвежских корпусов CHILDES)  

Ссылка на данные: [https://raw.githubusercontent.com/olesar/2025dav4compling/refs/heads/main/data/TatmanR_Lexical_acquisition_NO.csv]

### 3.1 Чтение данных  

Запишите данные в переменную `Norwegian_data`, предварительно удалив строки, в которых возраст усвоения слова не задан (`NA`). Ваш код должен выдавать количество строк в получившемся датасете. 

```{r norwegian_acquisition}
# YOUR CODE HERE

```

### 3.2 График плотности по категориям  

Интересно, какие категории слов дети осваивают раньше? Ниже приведен график плотности значений переменной `CumulOtherWords` по группам `BroadCategory`. Он, например, показывает, что количество ранее освоенных слов в категории `games & routines` растет быстрее, чем слов в категории `predicates`. Это может говорить о том, что слова, относящиеся к играм и ежедневным занятиям (*я спрятался*, *умываться*) дети осваивают раньше, чем более абстрактные глаголы (например, *купить* или *думать*)   

<img src="https://github.com/olesar/2025dav4compling/blob/main/img/TatmanR_Lexical_acquisition_NO_dens1.png?raw=true" width=60%>

Ваша задача - с помощью ggplot визуализировать график возраста освоения слов (Age of Acquisition) по группам BroadCategory, тема - `theme_bw`. В геоме плотности используйте аргумент сглаживания adjust со значением 2. Подпишите оси и график понятным читателю образом. В комментарии приведен пример использования функции `scale_x_continuous` в ggplot. С ее помощью подпишите ось X так, чтобы была ясна разбивка по полугоду (то есть 12, 18 месяцев и т. д.).       

```{r norwegian_density_age_by_broad}
# YOUR CODE HERE

#  scale_x_continuous(expand=c(0, 0),
#                    breaks = seq(0, 36, by = 6))
```

### 3.3 Интерпретация графика плотности  

```{txt density_interpretation} 
 YOUR ANSWER HERE

``` 

### 3.4 Возраст освоения VS кумулятивное количество ранее освоенных слов    

Постройте график рассеяния по переменным `AgeOfAcq` и `CumulOtherWords`, как показано ниже. Здесь использован геом `geom_count` с разбросом точек (jitter) и прозрачностью 0.5. Палитра - базовая. Предварительно, удалите из данных строки, для которых не указана `BroadCategory` (NA).   

<img src="https://github.com/olesar/2025dav4compling/blob/main/img/TatmanR_Lexical_acquisition_NO_scatt1.png?raw=true" width=70%>

```{r scatterplot}
# YOUR CODE HERE

``` 

### 3.5 Условия для проведения корреляционного анализа  

Условием для проведения корреляционного анализа Пирсона является нормальное распределение данных.  
Раскомментируйте код ниже, чтобы визуально оценить нормальность распределения переменной `AgeOfAcq` по графику QQ-plot (quantile-quantile plot). Данные откладываются по оси y, а по оси x откладываются значения, которые бы данные имели, если бы они были идеально нормальными (теоретические квантили). Если данные в выборке нормально распределены, все точки будут лежать на прямой. Полоса вокруг прямой показывает 95% доверительный интервал: если практически все точки попадают в этот интервал, это сильное свидетельство в пользу того, что данные в выборке распределены нормально. Данные распределены ненормально, если они образуют ломаный или сильно изогнутый паттерн, а также если они далеко отходят от прямой в той или иной области.  

```{r qqplot1}
# library(DescTools)
# PlotQQ(Norwegian_data$AgeOfAcq)
```

Постройте QQ-plot для переменной `CumulOtherWords`.

```{r qqplot2}
# YOUR CODE HERE

```

### 3.6 Корреляция `AgeOfAcq` и `CumulOtherWords`   

С помощью функции cor.test проведите корреляционный анализ. Ваши выводы из предыдущего пункта (3.5) подскажут, какой метод вы должны использовать.  

```{r cor_test}
# YOUR CODE HERE


```
### 3.7 Интерпретация результатов теста    

```{txt cor-test-interpret}
 YOUR ANSWER HERE
```

### 3.8 Степень свободы  

Сравните количество строк в датасете, по которому проводился корреляционный анализ, и степень свободы (df), указанную в результатах теста. Как получилось число df?    

```{txt df-interpret}
 YOUR ANSWER HERE
```

